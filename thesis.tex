%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% MASTERS/DOCTORAL THESIS TEMPLATE
%% Adapted for Universität der Bundeswehr München
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper,twoside,11pt]{MastersDoctoralThesis}

% Load custom packages and definitions
\input{defines}

%%%%% THESIS INFORMATION
\thesistitle{The Fuzzed and the Spurious - Compiler-Assisted Program Hardening and Fuzzing}
\author{Felix Berlakovich}
\degree{Doktor der Naturwissenschaften (Dr. rer. nat.)}
\university{Universität der Bundeswehr München}
\faculty{Fakultät für Informatik}
\department{Forschungsinstitut Cyber Defense (CODE)}
\supervisor{Prof. Dr. Stefan Brunthaler}
\examiner{Prof. Dr. Mathias Payer}
\crest{\includegraphics[width=4cm]{figures/unibw.pdf}}

%%%%% DRAFT OPTIONS
\fancyfoot[C]{\emph{DRAFT Printed on \today}}

%%%%% BIBLIOGRAPHY SETUP
\usepackage[style=ieee, sortcites=true, backend=bibtex, doi=true, isbn=false,
    maxnames=1, minnames=1, maxbibnames=99, citestyle=numeric-comp]{biblatex}
\newcommand*{\bibtitle}{References}

% Environment for the Publications page
\defbibenvironment{nolabel}
{\list{}{\leftmargin=0pt
\itemindent=0pt
\labelwidth=0pt
\labelsep=0pt
\setlength{\itemsep}{2ex}
\setlength{\parsep}{0pt}
}
\renewcommand*{\makelabel}[1]{}}%
{\endlist}
{\item}

% Select your publications by author name
\DeclareSourcemap{
    \maps[datatype=bibtex]{
        \map{
            \step[fieldsource=author, match=Berlakovich, final]
            \step[fieldset=keywords, fieldvalue=own]
        }
    }
}

\renewcommand*{\bibfont}{\footnotesize}
\DeclareLanguageMapping{latin}{english}
\BiblatexSplitbibDefernumbersWarningOff
\addbibresource{references.bib}

%%%%% PERSONAL MACROS
\renewcommand{\th}{\textsuperscript{th}}
\newcommand{\nd}{\textsuperscript{nd}}
\providecommand{\st}{}% ensure \st exists before renewing
\renewcommand{\st}{\textsuperscript{st}}
\newcommand{\rd}{\textsuperscript{rd}}

\input{preface/abbreviations}
\makeglossaries

%%%%% THE ACTUAL DOCUMENT STARTS HERE
\begin{document}

\setcounter{secnumdepth}{2}
\setcounter{tocdepth}{2}

%%%%% FRONT MATTER
\frontmatter

% Title page
\maketitle

%%%%% ACKNOWLEDGEMENTS
\begin{acknowledgements}
    \input{preface/acknowledgements}
\end{acknowledgements}

%%%%% KURZFASSUNG (German Abstract)
\begin{kurzfassung}
    \input{preface/kurzfassung}
\end{kurzfassung}

%%%%% ABSTRACT
\begin{abstract}
    \input{preface/abstract}
\end{abstract}

%%%%% TABLE OF CONTENTS
\tableofcontents

%%%%% LIST OF TODOS (only when todos are enabled)
\makeatletter
\@ifpackageloaded{todonotes}{%
    \ifdefined\@todonotes@disabled\else
    \listoftodos[TODOs]
    \addcontentsline{toc}{chapter}{TODOs}
    \fi
}{}
\makeatother

%%%%% LIST OF FIGURES
\listoffigures
\addcontentsline{toc}{chapter}{\listfigurename}

%%%%% LIST OF ABBREVIATIONS
\printglossary[type=\acronymtype,title=List of Abbreviations]
\addcontentsline{toc}{chapter}{List of Abbreviations}

%%%%% LIST OF PUBLICATIONS


\chapter*{Publications}
\addcontentsline{toc}{chapter}{Publications}
This dissertation is based in part on the following publications:
\vspace{2ex}
\begin{refsection}
    \nocite{berlakovich2023,schwarcz2024,berlakovich2026}
    \newrefcontext[sorting=ddnt]
    \printbibliography[heading=none, env=nolabel]
\end{refsection}
\vspace{6ex}
\begin{refsection}
    \nocite{berlakovich2024,berlakovich2022a}
    \noindent The following publications were not included in the thesis:
    \vspace{2ex}
    \newrefcontext[sorting=ddnt]
    \printbibliography[heading=none, env=nolabel]
    \vspace{2ex}
    \noindent  Cross-Module Quickening, while also compiler-related, aligns more with the traditional use of compilers as optimizers.
\end{refsection}


%%%%% MAIN MATTER
\mainmatter

\include{includes/introduction}\label{ch:introduction}

\partintro{\input{includes/part1-intro}}


\part{Defending Against Code-Reuse with Compiler Assistance}\label{part:defense}


\chapter{The Co-Evolution of Code-Reuse Attacks and Defenses}\label{ch:code-reuse-coevolution}
\input{includes/coevolution}


\chapter{Plugging Information Leaks With Mimicry}\label{ch:r2c}
\input{includes/r2c/motivation}
\input{includes/r2c/threat-model}
\input{includes/r2c/design}
\input{includes/r2c/implementation}
\input{includes/r2c/evaluation}
\input{includes/r2c/discussion}
\input{includes/r2c/limitations}
\input{includes/r2c/future-work}
\input{includes/r2c/summary}


\chapter{Outlook}\label{ch:outlook-defense}
\input{includes/outlook-defense}

\partintro{\input{includes/part2-intro}}
\part{Improving Fuzzer Guidance with Compiler Assistance}\label{part:fuzzing}

\chapter{Fuzzer Guidance}\label{ch:fuzzer-guidance}
\input{includes/fuzzer-guidance}

\chapter{Fuzzer Guidance with Optimization-Log Counters}\label{ch:lool}
\input{includes/lool/introduction}
\input{includes/lool/background}
\input{includes/lool/design}
\input{includes/lool/implementation}
\input{includes/lool/evaluation}
\input{includes/lool/discussion}
\input{includes/lool/future-work}
\input{includes/lool/summary}


\chapter{Fuzzer Guidance with Program State Projection}\label{ch:psp}
\input{includes/psp/motivation}
\input{includes/psp/background}
\input{includes/psp/psp}
\input{includes/psp/implementation}
\input{includes/psp/evaluation}
\input{includes/psp/discussion}
\input{includes/psp/future-work}
\input{includes/psp/summary}


\chapter{Outlook}\label{ch:outlook-fuzzing}
\input{includes/outlook-fuzzing}

\bookmarksetup{startatroot}


\chapter{Conclusion}
\input{includes/conclusion}

%%%%% APPENDICES
\appendix


\chapter{Appendix}
\input{appendices/appendix-1}

%%%%% BIBLIOGRAPHY
\backmatter
{\renewcommand*\MakeUppercase[1]{#1}%
\newrefcontext[sorting=none]%
\printbibliography[heading=bibintoc,title={\bibtitle}]}

\end{document}
