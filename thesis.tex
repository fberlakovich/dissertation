%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% MASTERS/DOCTORAL THESIS TEMPLATE
%% Adapted for Universität der Bundeswehr München
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper,twoside,11pt]{MastersDoctoralThesis}

% Load custom packages and definitions
\input{defines}

%%%%% THESIS INFORMATION
\thesistitle{To Optimization and Beyond - Compiler-assisted Program Hardening and Fuzzing}
\author{Felix Berlakovich}
\degree{Doktor der Naturwissenschaften (Dr. rer. nat.)}
\university{Universität der Bundeswehr München}
\faculty{Fakultät für Informatik}
\department{Informatik}
\supervisor{Prof. A}
\examiner{Prof. B}
\crest{\includegraphics[width=4cm]{figures/unibw.pdf}}

%%%%% DRAFT OPTIONS
\fancyfoot[C]{\emph{DRAFT Printed on \today}}

%%%%% BIBLIOGRAPHY SETUP
\usepackage[style=ieee, sortcites=true, backend=bibtex, doi=true, isbn=false,
    maxnames=1, minnames=1, maxbibnames=99, citestyle=numeric-comp]{biblatex}
\newcommand*{\bibtitle}{References}

% Environment for the Publications page
\defbibenvironment{nolabelspaced}
{\list{}{\leftmargin=0pt
\itemindent=0pt
\labelwidth=0pt
\labelsep=0pt
\setlength{\itemsep}{4ex}
\setlength{\parsep}{0pt}
}
\renewcommand*{\makelabel}[1]{}}%
{\endlist}
{\item}

% Select your publications by author name
\DeclareSourcemap{
    \maps[datatype=bibtex]{
        \map{
            \step[fieldsource=author, match=Berlakovich, final]
            \step[fieldset=keywords, fieldvalue=own]
        }
    }
}

\renewcommand*{\bibfont}{\small}
\DeclareLanguageMapping{latin}{english}
\BiblatexSplitbibDefernumbersWarningOff
\addbibresource{references.bib}

%%%%% PERSONAL MACROS
\renewcommand{\th}{\textsuperscript{th}}
\newcommand{\nd}{\textsuperscript{nd}}
\providecommand{\st}{}% ensure \st exists before renewing
\renewcommand{\st}{\textsuperscript{st}}
\newcommand{\rd}{\textsuperscript{rd}}

\input{preface/abbreviations}
\makeglossaries

%%%%% THE ACTUAL DOCUMENT STARTS HERE
\begin{document}

\setcounter{secnumdepth}{2}
\setcounter{tocdepth}{2}

%%%%% FRONT MATTER
\frontmatter

% Title page
\maketitle

%%%%% ACKNOWLEDGEMENTS
\begin{acknowledgements}
    \input{preface/acknowledgements}
\end{acknowledgements}

%%%%% KURZFASSUNG (German Abstract)
\begin{kurzfassung}
    \input{preface/kurzfassung}
\end{kurzfassung}

%%%%% ABSTRACT
\begin{abstract}
    \input{preface/abstract}
\end{abstract}

%%%%% TABLE OF CONTENTS
\tableofcontents

%%%%% LIST OF FIGURES
\listoffigures
\addcontentsline{toc}{chapter}{\listfigurename}

%%%%% LIST OF ABBREVIATIONS
\printglossary[type=\acronymtype,title=List of Abbreviations]
\addcontentsline{toc}{chapter}{List of Abbreviations}

%%%%% LIST OF PUBLICATIONS
\chapter*{Publications}
\addcontentsline{toc}{chapter}{Publications}
This dissertation is based in part on the following publications:
\vspace{2ex}
\newrefcontext[sorting=ddnt]
\printbibliography[keyword=own, nottype=unpublished, heading=none, env=nolabelspaced]

We deliberately did not include Cross-Module Quickening~\cite{berlakovich2024} in this thesis.
While the project is also compiler-related, it aligns more with the traditional use of compilers as optimizers.

%%%%% MAIN MATTER
\mainmatter

\include{includes/introduction}\label{ch:introduction}

\partintro{%
Memory-unsafe languages like C and \cpp remain the foundation of critical infrastructure, and with them, the threat of memory corruption vulnerabilities persists.
Among the most dangerous exploitation techniques are \glspl{CRA}, which hijack a program's control flow to execute attacker-chosen code sequences.

This part of the thesis explores how compiler-driven software diversity can defend against such attacks.
The compiler's intimate knowledge of program structure---stack layouts, function boundaries, and data dependencies---enables transformations that would be difficult or impossible to achieve through post-hoc binary rewriting or runtime instrumentation.

\Cref{ch:code-reuse-coevolution} traces the co-evolution of \glspl{CRA} and their defenses, establishing the context for our contribution.
The subsequent chapter then presents \rtwoc, a defense that leverages compiler knowledge to randomize not only code but also the observable data layouts that recent attacks exploit for reconnaissance.
}
\part{Defending Against Code-Reuse with Compiler Assistance}\label{part:defense}
\chapter{The Co-Evolution of Code-Reuse Attacks and Defenses}\label{ch:code-reuse-coevolution}
\input{includes/coevolution}
\chapter{Plugging Information Leaks With Mimicry}\label{ch:r2c}
\input{includes/r2c/motivation}
\input{includes/r2c/threat-model}
\input{includes/r2c/design}
\input{includes/r2c/implementation}
\input{includes/r2c/evaluation}
\input{includes/r2c/discussion}
\input{includes/r2c/limitations}
\input{includes/r2c/possible-extensions}
\input{includes/r2c/summary}
\chapter{Outlook}\label{ch:outlook-defense}
\input{includes/outlook-defense}

\partintro{%
While the first part of this thesis focused on hardening deployed programs against exploitation, this part addresses the complementary goal of finding bugs before deployment.
Fuzzing has emerged as one of the most effective techniques for discovering vulnerabilities in complex software, but its effectiveness depends critically on the feedback mechanisms that guide input generation.

The compiler is uniquely positioned to provide rich feedback signals.
Beyond the code coverage metrics that most fuzzers rely on, the compiler has access to semantic information about program structure, optimization decisions, and data dependencies.
This part explores two ways to leverage this information.

\Cref{ch:fuzzer-guidance} provides background on fuzzer feedback mechanisms and their limitations.
We then present \lool, a fuzzing framework that uses the compiler's optimization log as a domain-specific coverage metric for compiler testing.
Finally, we introduce \emph{Program State Convolution} (PSC), a technique that uses compiler analyses to project hidden data dependencies onto observable control flow, and present preliminary results exploring its potential.
}
\part{Improving Fuzzer-Guidance with Compiler Assistance}\label{part:fuzzing}
\input{includes/fuzzer-guidance}
\chapter{Fuzzer-Guidance with Optimization-Log Counters}\label{ch:lool}
\input{includes/lool/introduction}
\input{includes/lool/background}
\input{includes/lool/design}
\input{includes/lool/implementation}
\input{includes/lool/evaluation}
\input{includes/lool/discussion}
\input{includes/lool/future-work}
\chapter{Fuzzer-Guidance with Program-State Convolution}\label{ch:psc}
\input{includes/psc/motivation}
\input{includes/psc/background}
\input{includes/psc/psc}
\input{includes/psc/implementation}
\input{includes/psc/evaluation}
\chapter{Outlook}\label{ch:outlook-fuzzing}
\input{includes/outlook-fuzzing}

\bookmarksetup{startatroot}
\chapter{Conclusion}
\input{includes/conclusion}

%%%%% APPENDICES
\appendix
\chapter{Appendix}
\input{appendices/appendix-1}

%%%%% BIBLIOGRAPHY
\backmatter
{\renewcommand*\MakeUppercase[1]{#1}%
\newrefcontext[sorting=none]%
\printbibliography[heading=bibintoc,title={\bibtitle}]}

\end{document}
